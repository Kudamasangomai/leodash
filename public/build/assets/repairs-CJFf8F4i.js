import{g as a,b as e,o as d,y as I,p as x,u as N,a as l,d as r,h as K,w as u,i as p,f as c,F as y,s as R,t as i,n as O,e as T,j as _,z as j,v as z,G as Q}from"./app-CW_F-cfS.js";import{_ as W}from"./AuthenticatedLayout-CixoowGp.js";import{M as X}from"./MainContent-DXksavGb.js";import{P as Y,a as ee}from"./PageTitle-CuYS9h-1.js";import{P as k}from"./PrimaryButton-hppeLfBg.js";import{_ as D}from"./SecondaryButton-Dqg7rJgX.js";import{_ as A}from"./Modal-BK2M2NVw.js";import{D as te}from"./Deleteicon-BmHCwQ-r.js";import{E as se}from"./Editicon-C2tz1aLq.js";import{D as oe}from"./DangerButton-Bd3Ir_fj.js";import{S as V}from"./Spinner-Dt0u3Uu6.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={},ae={xmlns:"http://www.w3.org/2000/svg",fill:"#fff",viewBox:"0 0 24 29","stroke-width":"2",stroke:"#1F51FF",class:"inline-block w-5 h-6",height:"1em"};function de(b,f){return d(),a("svg",ae,[...f[0]||(f[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"},null,-1)])])}const ne=re(le,[["render",de]]),ie={key:0,class:"flex items-center gap-2"},ue={key:0,class:"flex items-center"},ce={class:"px-2 overflow-x-auto"},me={class:"min-w-full border border-gray-200"},pe={class:"text-center divide-y divide-gray-200"},fe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},xe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},be={class:"px-4 py-3 text-[14px] border-r border-gray-200"},ge={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ye={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ve={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},_e={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ke={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200 flex gap-2"},he=["onClick"],we=["onClick"],Ce=["onClick"],Fe={key:1},Me={class:"p-6 bg-white"},Se={class:"mb-4 text-lg font-medium text-gray-900"},Re=["value"],De={key:0,class:"mt-1 text-sm text-red-600"},Ae=["value"],Ve={key:0,class:"mt-1 text-sm text-red-600"},$e={key:0},Be={key:0,class:"mt-1 text-sm text-red-600"},Ne={class:"flex justify-end gap-3 mt-6"},Te={key:0,class:"flex items-center gap-2"},je={class:"p-6 bg-white"},ze={class:"flex justify-end gap-3 mt-6"},Le={class:"p-6 bg-white"},Pe={key:0,class:"mt-1 text-sm text-red-600"},Ee={class:"flex justify-end gap-3 mt-6"},Ue={key:0,class:"flex items-center gap-2"},et={__name:"repairs",props:{repairs:Array,trucks:Array,faults:Array},setup(b){I().props;const f=x(!1),h=x(!1),w=x(null),m=x(null),$=x(null),C=N({}),F=x(!1),s=N({truck_id:"",fault_id:"",status:"pending",location:"",comments:""}),L=()=>{m.value=null,s.reset(),f.value=!0},P=n=>{m.value=n,s.truck_id=n.truck_id,s.fault_id=n.fault_id,s.status=n.status,s.location=n.location,f.value=!0},E=n=>{$.value=n,s.truck_id=n.truck_id,s.truck=n.truck.unitname,s.comments=n.comments,s.fault=n.fault.name,s.fault_id=n.fault_id,F.value=!0},U=()=>{m.value?s.put(`/repairs/${m.value.id}`,{onSuccess:()=>v()}):s.post("/repairs",{onSuccess:()=>v()})},H=()=>{s.put(`/repairs/closerepair/${$.value.id}`,{onSuccess:()=>M()})},v=()=>{f.value=!1,s.reset(),m.value=null},M=()=>{F.value=!1,s.reset()},q=n=>{w.value=n,h.value=!0},S=()=>{h.value=!1,w.value=null},G=()=>{C.delete(`/repairs/${w.value.id}`,{onSuccess:()=>S()})},J=n=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-300 text-green-800",on_hold:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",g=x(!1);function Z(){g.value||(g.value=!0,Q.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{g.value=!1},preserveScroll:!0}))}return(n,t)=>(d(),a(y,null,[l(r(K),{title:"Repairs"}),l(W,null,{default:u(()=>[l(X,null,{default:u(()=>[l(Y,null,{default:u(()=>[l(ee,null,{default:u(()=>[...t[4]||(t[4]=[c("Repairs Management",-1)])]),_:1}),e("div",null,[l(k,{onClick:Z,disabled:g.value},{default:u(()=>[g.value?(d(),a("span",ie,[t[5]||(t[5]=c(" Fetching Locations ",-1)),l(V)])):(d(),a(y,{key:1},[c(" Fetch Locations ")],64))]),_:1},8,["disabled"]),l(k,{onClick:L},{default:u(()=>[...t[6]||(t[6]=[c(" + New Repair ",-1)])]),_:1})])]),_:1}),r(C).recentlySuccessful?(d(),a("span",ue,[...t[7]||(t[7]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):p("",!0),e("div",ce,[e("table",me,[t[9]||(t[9]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Truck"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Fault"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Status"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Location"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"last Reported At"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"last Checked At"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Created By"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Actions")])],-1)),e("tbody",pe,[b.repairs&&b.repairs.length?(d(!0),a(y,{key:0},R(b.repairs,o=>(d(),a("tr",{key:o.id,class:"odd:bg-gray-50"},[e("td",fe,i(o.truck.unitname),1),e("td",xe,i(o.fault.name),1),e("td",be,[e("span",{class:O(["px-3 py-2 rounded text-xs font-semibold",J(o.status)])},i(o.status),3)]),e("td",ge,i(o.location||"N/A"),1),e("td",ye,i(o.last_reported_at),1),e("td",ve,i(o.last_check_at||"N/A"),1),e("td",_e,i(o.user.name),1),e("td",ke,[e("button",{onClick:B=>P(o)},[l(se)],8,he),e("button",{title:"Close",class:"mr-2",onClick:B=>E(o)},[l(ne)],8,we),e("button",{onClick:B=>q(o)},[l(te)],8,Ce)])]))),128)):(d(),a("tr",Fe,[...t[8]||(t[8]=[e("td",{colspan:"8",class:"px-4 py-3 text-center text-gray-500"}," Nothing to show ",-1)])]))])])])]),_:1}),l(A,{show:f.value,onClose:v},{default:u(()=>[e("div",Me,[e("h2",Se,i(m.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:T(U,["prevent"]),class:"space-y-4"},[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Truck",-1)),_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>r(s).truck_id=o),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[10]||(t[10]=e("option",{value:""},"Select a truck",-1)),(d(!0),a(y,null,R(b.trucks,o=>(d(),a("option",{key:o.id,value:o.id},i(o.unitname),9,Re))),128))],512),[[j,r(s).truck_id]]),r(s).errors.truck_id?(d(),a("div",De,i(r(s).errors.truck_id),1)):p("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r(s).fault_id=o),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[12]||(t[12]=e("option",{value:""},"Select a Fault",-1)),(d(!0),a(y,null,R(b.faults,o=>(d(),a("option",{key:o.id,value:o.id},i(o.name),9,Ae))),128))],512),[[j,r(s).fault_id]]),r(s).errors.fault_id?(d(),a("div",Ve,i(r(s).errors.fault_id),1)):p("",!0)]),m.value?(d(),a("div",$e,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Location",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r(s).location=o),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[z,r(s).location]]),r(s).errors.location?(d(),a("div",Be,i(r(s).errors.location),1)):p("",!0)])):p("",!0),e("div",Ne,[l(D,{onClick:v},{default:u(()=>[...t[15]||(t[15]=[c("Cancel",-1)])]),_:1}),l(k,{type:"submit",disabled:r(s).processing},{default:u(()=>[c(i(m.value?"Update":"Create")+" ",1),g.value||r(s).processing?(d(),a("span",Te,[l(V)])):p("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),l(A,{show:h.value,onClose:S},{default:u(()=>[e("div",je,[t[18]||(t[18]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",ze,[l(D,{onClick:S},{default:u(()=>[...t[16]||(t[16]=[c("Cancel",-1)])]),_:1}),l(oe,{onClick:G,disabled:r(C).processing},{default:u(()=>[...t[17]||(t[17]=[c(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"]),l(A,{show:F.value,onClose:M},{default:u(()=>[e("div",Le,[t[22]||(t[22]=e("h2",{class:"mb-4 text-lg font-medium text-gray-900"}," Close Repair ",-1)),e("h6",null," Truck - "+i(r(s).truck),1),e("h6",null," Fault - "+i(r(s).fault),1),e("form",{onSubmit:T(H,["prevent"]),class:"space-y-4"},[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700"},"Job Done / comment",-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r(s).comments=o),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[z,r(s).comments]]),r(s).errors.comments?(d(),a("div",Pe,i(r(s).errors.comments),1)):p("",!0),e("div",Ee,[l(D,{onClick:M},{default:u(()=>[...t[19]||(t[19]=[c("Cancel",-1)])]),_:1}),l(k,{type:"submit",disabled:r(s).processing},{default:u(()=>[t[20]||(t[20]=c(" Close ",-1)),r(s).processing?(d(),a("span",Ue,[l(V)])):p("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"])]),_:1})],64))}};export{et as default};

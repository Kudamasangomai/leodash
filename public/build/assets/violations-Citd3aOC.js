import{p as y,u as F,g as n,a as o,d as c,h as M,w as d,b as t,f as u,e as B,i as h,o as i,t as l,F as _,s as C}from"./app-CFctwJUb.js";import{_ as P}from"./AuthenticatedLayout-B2zhfDx8.js";import{M as $}from"./MainContent-BqYjeDEe.js";import{P as N,a as T}from"./PageTitle-bdYtiNcP.js";import{P as j}from"./PrimaryButton-C2TEAID9.js";import{a as v,_ as k}from"./SecondaryButton-_AraB19F.js";import{S as O}from"./Spinner-CrjMbxhU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"p-6 mb-4 space-y-6 shadow-sm bg-white rounded-md"},L={key:0,class:"mt-1 text-sm text-red-600"},R={class:"flex items-center"},q={key:0,class:"flex items-center"},A={class:"mb-2 text-lg font-bold"},G={class:"mb-2 text-right"},H=["onClick"],I={class:"px-2 overflow-x-auto"},z={class:"min-w-full border border-gray-200"},J=["id"],K={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Q={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},W={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},X={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Y={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Z={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},tt={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},et={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},st={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ot={key:1,class:"py-6 text-center text-xl"},lt={class:"p-4"},rt={class:"flex justify-end mt-6"},at={class:"p-4"},dt={class:"text-lg font-medium text-gray-900"},nt={class:"font-bold"},it={class:"flex justify-end mt-6"},_t={__name:"violations",props:{violations:Object},setup(E){const m=y(!1),x=y(!1),b=()=>{m.value=!1,x.value=!1},a=F({file:null});function S(s){const e=s.target.files&&s.target.files[0]?s.target.files[0]:null;a.file=e}function D(){a.file&&a.post("/violations/upload",{preserveScroll:!0,onSuccess:()=>{a.reset(),m.value=!0},onError:s=>{alert(s.file??"Failed To Upload"),a.reset()}})}const g=y("");function V(s){g.value=s,x.value=!0}function w(s){const e=document.getElementById("table-"+s);if(!e)return;const p=document.createElement("textarea");p.value=e.innerText,document.body.appendChild(p),p.select(),document.execCommand("copy"),document.body.removeChild(p),x.value=!0,V(s)}return(s,e)=>(i(),n(_,null,[o(c(M),{title:"Violations"}),o(P,null,{default:d(()=>[o($,null,{default:d(()=>[o(N,null,{default:d(()=>[o(T,null,{default:d(()=>[...e[1]||(e[1]=[u(" Daily Violations Report",-1)])]),_:1}),e[2]||(e[2]=t("div",null,[t("div")],-1))]),_:1}),t("div",U,[t("form",{onSubmit:B(D,["prevent"]),enctype:"multipart/form-data",class:"space-y-4"},[e[6]||(e[6]=t("div",{class:"text-blue-500 font-bold"}," Download the Events report as csv then convert to .xls or .xlsx then upload ",-1)),t("div",null,[e[3]||(e[3]=t("label",{class:"block text-sm font-medium text-gray-700"}," Select Excel File (.xls or .xlsx) ",-1)),t("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:S,required:"",class:"block w-full p-4 mt-1 text-sm text-gray-700"},null,32),c(a).errors.file?(i(),n("div",L,l(c(a).errors.file),1)):h("",!0)]),t("div",R,[o(j,{type:"submit",disabled:c(a).processing},{default:d(()=>[e[4]||(e[4]=u(" Upload ",-1)),c(a).processing?(i(),n("span",q,[o(O)])):h("",!0)]),_:1},8,["disabled"]),o(v,{type:"button",class:"ms-3",onClick:e[0]||(e[0]=p=>c(a).reset("file"))},{default:d(()=>[...e[5]||(e[5]=[u(" Cancel ",-1)])]),_:1})])],32)]),s.group&&s.group.length?(i(!0),n(_,{key:0},C(E.violations,(p,f)=>(i(),n("div",{key:f,class:"mb-8 text-center py-4"},[t("h2",A,l(f)+" Events",1),t("div",G,[t("button",{onClick:r=>w(f),class:"px-3 py-1 text-white bg-blue-500 rounded hover:bg-blue-600"}," Copy Table ",8,H)]),t("div",I,[t("table",z,[e[7]||(e[7]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"p-2 border"},"Date"),t("th",{class:"p-2 border"},"Asset"),t("th",{class:"p-2 border"},"Driver"),t("th",{class:"p-2 border"},"Location"),t("th",{class:"p-2 border"},"Duration"),t("th",{class:"p-2 border"},"Max Speed"),t("th",{class:"p-2 border"},"Destination"),t("th",{class:"p-2 border"},"Coordinates"),t("th",{class:"p-2 border"},"Event")])],-1)),t("tbody",{id:"table-"+f,class:"divide-y divide-gray-200 whitespace-nowrap"},[(i(!0),n(_,null,C(p,r=>(i(),n("tr",{key:r.id,class:"text-center odd:bg-gray-50"},[t("td",K,l(r.date),1),t("td",Q,l(r.asset),1),t("td",W,l(r.driver),1),t("td",X,l(r.location),1),t("td",Y,l(r.duration),1),t("td",Z,l(r.max_speed),1),t("td",tt,l(r.destination),1),t("td",et,l(r.coordinates),1),t("td",st,l(r.event_type),1)]))),128))],8,J)])])]))),128)):(i(),n("div",ot," Violations Table Empty "))]),_:1}),o(k,{show:m.value,onClose:b},{default:d(()=>[t("div",lt,[e[9]||(e[9]=t("h2",{class:"text-lg font-medium text-gray-900"}," Violation Report Succesfully Generated ",-1)),t("div",rt,[o(v,{onClick:b},{default:d(()=>[...e[8]||(e[8]=[u(" Ok ",-1)])]),_:1})])])]),_:1},8,["show"]),o(k,{show:x.value,onClose:b},{default:d(()=>[t("div",at,[t("h2",dt,[t("span",nt,l(g.value),1),e[10]||(e[10]=u(" Succesfully Copied to Clipboard ",-1))]),t("div",it,[o(v,{onClick:b},{default:d(()=>[...e[11]||(e[11]=[u(" Ok ",-1)])]),_:1})])])]),_:1},8,["show"])]),_:1})],64))}};export{_t as default};

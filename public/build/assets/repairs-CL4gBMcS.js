import{p as U,q as f,u as D,g as a,a as o,d as l,h as j,w as u,i as b,b as e,f as p,o as d,F as g,s as C,t as i,n as q,e as H,k as F,C as M,m as G,D as I}from"./app-DCjfw5Qe.js";import{_ as J}from"./AuthenticatedLayout-YTVUFVn9.js";import{M as K}from"./MainContent-C5GHXImD.js";import{P as O,a as Q}from"./PageTitle-BuDo2pys.js";import{P as S}from"./PrimaryButton-iEG0xoRo.js";import{_ as A,a as R}from"./Modal-BKk532xn.js";import{D as W}from"./Deleteicon-CmjzT2AY.js";import{E as X}from"./Editicon-u2fNanso.js";import{D as Y}from"./DangerButton-ggl727O9.js";import{S as E}from"./Spinner-B9RPZ74r.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={key:0,class:"flex items-center gap-2"},ee={key:0,class:"flex items-center"},te={class:"px-2 overflow-x-auto"},se={class:"min-w-full border border-gray-200"},re={class:"text-center divide-y divide-gray-200"},oe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},le={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ae={class:"px-4 py-3 text-[14px] border-r border-gray-200"},de={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ne={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ie={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ue={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ce={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200 flex gap-2"},pe=["onClick"],me=["onClick"],be={key:1},xe={class:"p-6 bg-white"},fe={class:"mb-4 text-lg font-medium text-gray-900"},ge=["value"],ye={key:0,class:"mt-1 text-sm text-red-600"},ve=["value"],_e={key:0,class:"mt-1 text-sm text-red-600"},ke={key:0},he={key:0,class:"mt-1 text-sm text-red-600"},we={class:"flex justify-end gap-3 mt-6"},Ce={key:0,class:"flex items-center gap-2"},Fe={class:"p-6 bg-white"},Se={class:"flex justify-end gap-3 mt-6"},Te={__name:"repairs",props:{repairs:Array,trucks:Array,faults:Array},setup(x){U().props;const y=f(!1),_=f(!1),k=f(null),c=f(null),r=D({truck_id:"",fault_id:"",status:"pending",location:""}),h=D({}),N=()=>{c.value=null,r.reset(),y.value=!0},V=n=>{c.value=n,r.truck_id=n.truck_id,r.fault_id=n.fault_id,r.status=n.status,r.location=n.location,y.value=!0},v=()=>{y.value=!1,r.reset(),c.value=null},B=()=>{c.value?r.put(`/repairs/${c.value.id}`,{onSuccess:()=>v(),onError:n=>{console.log("Errors:",n)}}):r.post("/repairs",{onSuccess:()=>v(),onError:n=>{console.log("Errors:",n)}})},$=n=>{k.value=n,_.value=!0},w=()=>{_.value=!1,k.value=null},L=()=>{h.delete(`/repairs/${k.value.id}`,{onSuccess:()=>w()})},P=n=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",on_hold:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",m=f(!1);function T(){m.value||(m.value=!0,I.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{m.value=!1},preserveScroll:!0}))}return(n,t)=>(d(),a(g,null,[o(l(j),{title:"Repairs"}),o(J,null,{default:u(()=>[o(K,null,{default:u(()=>[o(O,null,{default:u(()=>[o(Q,null,{default:u(()=>[...t[3]||(t[3]=[p("Repairs Management",-1)])]),_:1}),e("div",null,[o(S,{onClick:T,disabled:m.value},{default:u(()=>[m.value?(d(),a("span",Z,[t[4]||(t[4]=p(" Fetching Locations ",-1)),o(E)])):(d(),a(g,{key:1},[p(" Fetch Locations ")],64))]),_:1},8,["disabled"]),o(S,{onClick:N},{default:u(()=>[...t[5]||(t[5]=[p(" + New Repair ",-1)])]),_:1})])]),_:1}),l(h).recentlySuccessful?(d(),a("span",ee,[...t[6]||(t[6]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):b("",!0),e("div",te,[e("table",se,[t[8]||(t[8]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border border-r border-gray-300"},"Truck"),e("th",{class:"p-2 border border-r border-gray-300"},"Fault"),e("th",{class:"p-2 border border-r border-gray-300"},"Status"),e("th",{class:"p-2 border border-r border-gray-300"},"Location"),e("th",{class:"p-2 border border-r border-gray-300"},"last Reported At"),e("th",{class:"p-2 border border-r border-gray-300"},"last Checked At"),e("th",{class:"p-2 border border-r border-gray-300"},"Created By"),e("th",{class:"p-2 border border-r border-gray-300"},"Actions")])],-1)),e("tbody",re,[x.repairs&&x.repairs.length?(d(!0),a(g,{key:0},C(x.repairs,s=>(d(),a("tr",{key:s.id,class:"odd:bg-gray-50"},[e("td",oe,i(s.truck.unitname),1),e("td",le,i(s.fault.name),1),e("td",ae,[e("span",{class:q(["px-3 py-2 rounded text-xs font-semibold",P(s.status)])},i(s.status),3)]),e("td",de,i(s.location||"N/A"),1),e("td",ne,i(s.last_reported_at),1),e("td",ie,i(s.last_check_at||"N/A"),1),e("td",ue,i(s.user.name),1),e("td",ce,[e("button",{onClick:z=>V(s)},[o(X)],8,pe),e("button",{onClick:z=>$(s)},[o(W)],8,me)])]))),128)):(d(),a("tr",be,[...t[7]||(t[7]=[e("td",{colspan:"8",class:"px-4 py-3 text-center text-gray-500"}," Nothing to show ",-1)])]))])])])]),_:1}),o(A,{show:y.value,onClose:v},{default:u(()=>[e("div",xe,[e("h2",fe,i(c.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:H(B,["prevent"]),class:"space-y-4"},[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"Truck",-1)),F(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>l(r).truck_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[9]||(t[9]=e("option",{value:""},"Select a truck",-1)),(d(!0),a(g,null,C(x.trucks,s=>(d(),a("option",{key:s.id,value:s.id},i(s.unitname),9,ge))),128))],512),[[M,l(r).truck_id]]),l(r).errors.truck_id?(d(),a("div",ye,i(l(r).errors.truck_id),1)):b("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l(r).fault_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[11]||(t[11]=e("option",{value:""},"Select a Fault",-1)),(d(!0),a(g,null,C(x.faults,s=>(d(),a("option",{key:s.id,value:s.id},i(s.name),9,ve))),128))],512),[[M,l(r).fault_id]]),l(r).errors.fault_id?(d(),a("div",_e,i(l(r).errors.fault_id),1)):b("",!0)]),c.value?(d(),a("div",ke,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Location",-1)),F(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l(r).location=s),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[G,l(r).location]]),l(r).errors.location?(d(),a("div",he,i(l(r).errors.location),1)):b("",!0)])):b("",!0),e("div",we,[o(R,{onClick:v},{default:u(()=>[...t[14]||(t[14]=[p("Cancel",-1)])]),_:1}),o(S,{type:"submit",disabled:l(r).processing},{default:u(()=>[p(i(c.value?"Update":"Create")+" ",1),m.value||l(r).processing?(d(),a("span",Ce,[o(E)])):b("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),o(A,{show:_.value,onClose:w},{default:u(()=>[e("div",Fe,[t[17]||(t[17]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",Se,[o(R,{onClick:w},{default:u(()=>[...t[15]||(t[15]=[p("Cancel",-1)])]),_:1}),o(Y,{onClick:L,disabled:l(h).processing},{default:u(()=>[...t[16]||(t[16]=[p(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64))}};export{Te as default};

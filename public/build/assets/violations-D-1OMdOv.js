import{p as y,u as F,g as n,a as s,d as p,h as M,w as a,b as t,f as u,e as B,i as h,o as c,t as o,F as _,s as C}from"./app-Cbg-TvRk.js";import{_ as N}from"./AuthenticatedLayout-CrP1IZML.js";import{M as P}from"./MainContent-Btj49-6j.js";import{P as $,a as j}from"./PageTitle-CpPTCgXs.js";import{P as O}from"./PrimaryButton-QfSp1xYP.js";import{a as g,_ as k}from"./SecondaryButton-DUIlwm0n.js";import{S as L}from"./Spinner-BzsEjpUj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"p-6 mb-4 space-y-6 shadow-sm bg-white rounded-md"},T={key:0,class:"mt-1 text-sm text-red-600"},U={class:"flex items-center"},q={key:0,class:"flex items-center"},A={class:"mb-2 text-lg font-bold"},G={class:"mb-2 text-right"},H=["onClick"],I={class:"px-2 overflow-x-auto"},z={class:"min-w-full border border-gray-200"},J=["id"],K={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Q={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},W={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},X={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Y={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Z={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},tt={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},et={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},st={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ot={key:1},lt={class:"p-4"},rt={class:"flex justify-end mt-6"},at={class:"p-4"},dt={class:"text-lg font-medium text-gray-900"},it={class:"font-bold"},nt={class:"flex justify-end mt-6"},_t={__name:"violations",props:{violations:Object},setup(S){const b=y(!1),x=y(!1),f=()=>{b.value=!1,x.value=!1},d=F({file:null});function E(l){const e=l.target.files&&l.target.files[0]?l.target.files[0]:null;d.file=e}function w(){d.file&&d.post("/violations/upload",{preserveScroll:!0,onSuccess:()=>{d.reset(),b.value=!0},onError:l=>{alert(l.file??"Excel import failed"),form.reset()}})}const v=y("");function D(l){v.value=l,x.value=!0}function V(l){const e=document.getElementById("table-"+l);if(!e)return;const i=document.createElement("textarea");i.value=e.innerText,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),x.value=!0,D(l)}return(l,e)=>(c(),n(_,null,[s(p(M),{title:"Violations"}),s(N,null,{default:a(()=>[s(P,null,{default:a(()=>[s($,null,{default:a(()=>[s(j,null,{default:a(()=>[...e[1]||(e[1]=[u(" Daily Violations Report",-1)])]),_:1}),e[2]||(e[2]=t("div",null,[t("div")],-1))]),_:1}),t("div",R,[t("form",{onSubmit:B(w,["prevent"]),enctype:"multipart/form-data",class:"space-y-4"},[t("div",null,[e[3]||(e[3]=t("label",{class:"block text-sm font-medium text-gray-700"}," Select Excel File (.xls or .xlsx) ",-1)),t("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:E,required:"",class:"block w-full p-4 mt-1 text-sm text-gray-700"},null,32),p(d).errors.file?(c(),n("div",T,o(p(d).errors.file),1)):h("",!0)]),t("div",U,[s(O,{type:"submit",disabled:p(d).processing},{default:a(()=>[e[4]||(e[4]=u(" Upload ",-1)),p(d).processing?(c(),n("span",q,[s(L)])):h("",!0)]),_:1},8,["disabled"]),s(g,{type:"button",class:"ms-3",onClick:e[0]||(e[0]=i=>p(d).reset("file"))},{default:a(()=>[...e[5]||(e[5]=[u(" Cancel ",-1)])]),_:1})])],32)]),(c(!0),n(_,null,C(S.violations,(i,m)=>(c(),n("div",{key:m,class:"mb-8 text-center py-4"},[t("h2",A,o(m)+" Events",1),t("div",G,[t("button",{onClick:r=>V(m),class:"px-3 py-1 text-white bg-blue-500 rounded hover:bg-blue-600"}," Copy Table ",8,H)]),t("div",I,[t("table",z,[e[7]||(e[7]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"p-2 border"},"Date"),t("th",{class:"p-2 border"},"Asset"),t("th",{class:"p-2 border"},"Driver"),t("th",{class:"p-2 border"},"Location"),t("th",{class:"p-2 border"},"Duration"),t("th",{class:"p-2 border"},"Max Speed"),t("th",{class:"p-2 border"},"Destination"),t("th",{class:"p-2 border"},"Coordinates"),t("th",{class:"p-2 border"},"Event")])],-1)),t("tbody",{id:"table-"+m,class:"divide-y divide-gray-200 whitespace-nowrap"},[i?(c(!0),n(_,{key:0},C(i,r=>(c(),n("tr",{key:r.id,class:"text-center odd:bg-gray-50"},[t("td",K,o(r.date),1),t("td",Q,o(r.asset),1),t("td",W,o(r.driver),1),t("td",X,o(r.location),1),t("td",Y,o(r.duration),1),t("td",Z,o(r.max_speed),1),t("td",tt,o(r.destination),1),t("td",et,o(r.coordinates),1),t("td",st,o(r.event_type),1)]))),128)):(c(),n("tr",ot,[...e[6]||(e[6]=[t("td",{colspan:"6",class:"py-3 text-center"}," Nothing to show ",-1)])]))],8,J)])])]))),128))]),_:1}),s(k,{show:b.value,onClose:f},{default:a(()=>[t("div",lt,[e[9]||(e[9]=t("h2",{class:"text-lg font-medium text-gray-900"}," Violation Report Succesfully Generated ",-1)),t("div",rt,[s(g,{onClick:f},{default:a(()=>[...e[8]||(e[8]=[u(" Ok ",-1)])]),_:1})])])]),_:1},8,["show"]),s(k,{show:x.value,onClose:f},{default:a(()=>[t("div",at,[t("h2",dt,[t("span",it,o(v.value),1),e[10]||(e[10]=u(" Succesfully Copied to Clipboard ",-1))]),t("div",nt,[s(g,{onClick:f},{default:a(()=>[...e[11]||(e[11]=[u(" Ok ",-1)])]),_:1})])])]),_:1},8,["show"])]),_:1})],64))}};export{_t as default};

import{g as n,b as e,o as d,p as f,u as U,E as W,G as z,a as i,d as l,h as X,w as u,i as b,f as c,F as g,j as _,v as N,s as w,t as r,n as h,c as Y,l as ee,e as E,z as C}from"./app-D4ECur40.js";import{_ as te}from"./AuthenticatedLayout-BfGRn29t.js";import{M as se}from"./MainContent-1onqPwGA.js";import{P as oe,a as le}from"./PageTitle-Dq0VTMyF.js";import{P as F}from"./PrimaryButton-C5LzaIen.js";import{_ as S,a as $}from"./SecondaryButton-CaJ3a16E.js";import{D as re}from"./Deleteicon-Bh_Edao6.js";import{E as de}from"./Editicon-BQSCdEux.js";import{D as ae}from"./DangerButton-CAMlE9jG.js";import{S as L}from"./Spinner-D8hIY4bw.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={},ue={xmlns:"http://www.w3.org/2000/svg",fill:"#fff",viewBox:"0 0 24 29","stroke-width":"2",stroke:"#1F51FF",class:"inline-block w-5 h-6 mt-1",height:"1em"};function me(x,y){return d(),n("svg",ue,[...y[0]||(y[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"},null,-1)])])}const pe=ne(ie,[["render",me]]),ce={key:0,class:"flex items-center gap-2"},fe={key:0,class:"flex items-center"},be={class:"py-4 ml-2"},xe={class:"relative flex justify-end w-full mt-1 mr-1 md:w-1/3 md:ml-auto"},ye={class:"px-2 overflow-x-auto"},ve={class:"min-w-full border border-gray-200"},ge={class:"text-center divide-y divide-gray-200"},_e={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ke={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},we=["onClick"],he={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Ce={class:"px-4 py-3 text-[14px] border-r border-gray-200"},Fe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Se={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Re={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Me={class:"px-4 py-3 text-[14px] justify-center text-slate-900 border-r border-gray-200 flex gap-2"},De=["onClick"],je=["onClick"],Ae=["onClick"],Ve={key:1},Be={class:"flex gap-2 mt-4 justify-end"},Ne={class:"p-6 bg-white"},$e={class:"mb-4 text-lg font-medium text-gray-900"},Le=["value"],Te={key:0,class:"mt-1 text-sm text-red-600"},Ue=["value"],ze={key:0,class:"mt-1 text-sm text-red-600"},Ee={key:0},He={key:0,class:"mt-1 text-sm text-red-600"},qe={class:"flex justify-end gap-3 mt-6"},Pe={key:0,class:"flex items-center gap-2"},Oe={class:"p-6 bg-white"},Je={class:"flex justify-end gap-3 mt-6"},Ge={class:"p-6 bg-white"},Ze={key:0,class:"mt-1 text-sm text-red-600"},Ie=["value"],Ke={key:0,class:"mt-1 text-sm text-red-600"},Qe={key:0,class:"mt-1 text-sm text-red-600"},We={class:"flex justify-end gap-3 mt-6"},Xe={key:0,class:"flex items-center gap-2"},Ye={class:"bg-white rounded-2xl shadow-xl p-6 w-full"},et={class:"flex items-center justify-between mb-5"},tt={class:"space-y-4"},st={class:"flex justify-between"},ot={class:"font-medium"},lt={class:"flex justify-between"},rt={class:"font-medium"},dt={class:"flex justify-between"},at={class:"font-medium"},nt={class:"flex justify-between"},it={class:"font-medium"},ut={class:"flex justify-between"},mt={class:"font-medium"},pt={class:"pt-3 border-t"},ct={class:"bg-gray-200 rounded-lg p-3"},Ft={__name:"repairs",props:{repairs:Object,trucks:Array,faults:Array,users:Array},setup(x){const y=f(!1),R=f(!1),M=f(null),v=f(null),T=f(null),D=U({}),j=f(!1),A=f(!1),m=f(null),o=U({truck_id:"",fault_id:"",status:"pending",location:"",comments:"",donebyid:"",repairedondate:""}),H=()=>{v.value=null,o.reset(),y.value=!0},q=a=>{v.value=a,o.truck_id=a.truck_id,o.fault_id=a.fault_id,o.status=a.status,o.location=a.location,o.repairedondate=a.repairedondate,y.value=!0},P=a=>{T.value=a,o.truck_id=a.truck_id,o.truck=a.truck.unitname,o.comments=a.comments,o.fault=a.fault.name,o.fault_id=a.fault_id,j.value=!0},O=()=>{v.value?o.put(`/repairs/${v.value.id}`,{onSuccess:()=>p()}):o.post("/repairs",{onSuccess:()=>p()})},J=()=>{o.put(`/repairs/closerepair/${T.value.id}`,{onSuccess:()=>p()})},p=()=>{o.reset(),y.value=!1,v.value=null,j.value=!1,R.value=!1,M.value=null,A.value=!1,m.value=null},G=a=>{M.value=a,R.value=!0},Z=()=>{D.delete(`/repairs/${M.value.id}`,{onSuccess:()=>p()})},I=a=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-300 text-green-800",on_hold:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",k=f(!1);function K(){k.value||(k.value=!0,z.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{k.value=!1},preserveScroll:!0}))}const V=f("");W(V,a=>{z.get("/repairs",a?{q:a}:{},{preserveState:!0,preserveScroll:!0,replace:!0})});function Q(a){m.value=a,A.value=!0}return(a,t)=>(d(),n(g,null,[i(l(X),{title:"Repairs"}),i(te,null,{default:u(()=>[i(se,null,{default:u(()=>[i(oe,null,{default:u(()=>[i(le,null,{default:u(()=>[...t[7]||(t[7]=[c("Repairs Management",-1)])]),_:1}),e("div",null,[i(F,{onClick:K,disabled:k.value},{default:u(()=>[k.value?(d(),n("span",ce,[t[8]||(t[8]=c(" Fetching Locations ",-1)),i(L)])):(d(),n(g,{key:1},[c(" Fetch Locations ")],64))]),_:1},8,["disabled"]),i(F,{onClick:H},{default:u(()=>[...t[9]||(t[9]=[c(" + New Repair ",-1)])]),_:1})])]),_:1}),l(D).recentlySuccessful?(d(),n("span",fe,[...t[10]||(t[10]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):b("",!0),e("div",be,[t[11]||(t[11]=e("label",{for:"table-search",class:"sr-only"},"Search",-1)),e("div",xe,[_(e("input",{type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm",placeholder:"Search for truck or Fault","onUpdate:modelValue":t[0]||(t[0]=s=>V.value=s)},null,512),[[N,V.value]])])]),e("div",ye,[e("table",ve,[t[14]||(t[14]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Date "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Truck "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Fault "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Status "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Location "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Last Reported At "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Last Checked At "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Created By - Repaired By "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Actions ")])],-1)),e("tbody",ge,[x.repairs.data&&x.repairs.data.length?(d(!0),n(g,{key:0},w(x.repairs.data,s=>(d(),n("tr",{key:s.id,class:"odd:bg-gray-50"},[e("td",_e,r(s.created_at),1),e("td",ke,[e("button",{onClick:B=>Q(s),class:"text-blue-500"},r(s.truck.unitname),9,we)]),e("td",he,r(s.fault.name),1),e("td",Ce,[e("span",{class:h(["px-3 py-2 rounded text-xs font-semibold",I(s.status)])},r(s.status),3)]),e("td",Fe,r(s.location||"N/A"),1),e("td",{class:h([s.days_without_report>1?"bg-red-200":"","px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"])},r(s.last_reported_at),3),e("td",Se,r(s.last_check_at||"N/A"),1),e("td",Re,[c(r(s.user.name),1),t[12]||(t[12]=e("br",null,null,-1)),c(" "+r(s.done_by?.name),1)]),e("td",Me,[e("button",{onClick:B=>q(s)},[i(de)],8,De),e("button",{title:"Close",class:"mr-2",onClick:B=>P(s)},[i(pe)],8,je),e("button",{onClick:B=>G(s)},[i(re)],8,Ae)])]))),128)):(d(),n("tr",Ve,[...t[13]||(t[13]=[e("td",{colspan:"8",class:"px-4 py-3 text-center"}," Nothing to show ",-1)])]))])]),e("div",Be,[(d(!0),n(g,null,w(x.repairs.links,s=>(d(),Y(l(ee),{key:s.label,href:s.url??"",innerHTML:s.label,class:h(["px-3 py-1 border rounded border-gray-200",{"bg-blue-500 text-white":s.active,"text-gray-400":!s.url}]),"preserve-scroll":""},null,8,["href","innerHTML","class"]))),128))])])]),_:1}),i(S,{show:y.value,onClose:p},{default:u(()=>[e("div",Ne,[e("h2",$e,r(v.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:E(O,["prevent"]),class:"space-y-4"},[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium"},"Truck",-1)),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l(o).truck_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[15]||(t[15]=e("option",{value:""},"Select a truck",-1)),(d(!0),n(g,null,w(x.trucks,s=>(d(),n("option",{key:s.id,value:s.id},r(s.unitname),9,Le))),128))],512),[[C,l(o).truck_id]]),l(o).errors.truck_id?(d(),n("div",Te,r(l(o).errors.truck_id),1)):b("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium"},"Fault",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l(o).fault_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[17]||(t[17]=e("option",{value:""},"Select a Fault",-1)),(d(!0),n(g,null,w(x.faults,s=>(d(),n("option",{key:s.id,value:s.id},r(s.name),9,Ue))),128))],512),[[C,l(o).fault_id]]),l(o).errors.fault_id?(d(),n("div",ze,r(l(o).errors.fault_id),1)):b("",!0)]),a.editinguser?(d(),n("div",Ee,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium"},"Role",-1)),_(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>l(o).role=s),id:"inputState",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[...t[19]||(t[19]=[e("option",{value:"1"},"Admin",-1),e("option",{value:"0"},"User",-1)])],512),[[C,l(o).role]]),l(o).errors.role?(d(),n("div",He,r(l(o).errors.role),1)):b("",!0)])):b("",!0),e("div",qe,[i($,{onClick:p},{default:u(()=>[...t[21]||(t[21]=[c("Cancel",-1)])]),_:1}),i(F,{type:"submit",disabled:l(o).processing},{default:u(()=>[c(r(v.value?"Update":"Create")+" ",1),k.value||l(o).processing?(d(),n("span",Pe,[i(L)])):b("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),i(S,{show:R.value,onClose:p},{default:u(()=>[e("div",Oe,[t[24]||(t[24]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",Je,[i($,{onClick:p},{default:u(()=>[...t[22]||(t[22]=[c("Cancel",-1)])]),_:1}),i(ae,{onClick:Z,disabled:l(D).processing},{default:u(()=>[...t[23]||(t[23]=[c(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"]),i(S,{show:j.value,onClose:p},{default:u(()=>[e("div",Ge,[t[31]||(t[31]=e("h2",{class:"mb-4 text-lg font-medium text-gray-900"}," Close Repair ",-1)),e("h6",null,"Truck - "+r(l(o).truck),1),e("h6",null,"Fault - "+r(l(o).fault),1),e("form",{onSubmit:E(J,["prevent"]),class:"space-y-4"},[t[30]||(t[30]=e("label",{class:"block text-sm font-medium"},"Job Done / comment",-1)),_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l(o).comments=s),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[N,l(o).comments]]),l(o).errors.comments?(d(),n("div",Ze,r(l(o).errors.comments),1)):b("",!0),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium"},"Fault",-1)),_(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l(o).donebyid=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[25]||(t[25]=e("option",{value:""},"Done By",-1)),(d(!0),n(g,null,w(x.users,s=>(d(),n("option",{key:s.id,value:s.id},r(s.name),9,Ie))),128))],512),[[C,l(o).donebyid]]),l(o).errors.fault_id?(d(),n("div",Ke,r(l(o).errors.user_id),1)):b("",!0)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium"},"Repaired On",-1)),_(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l(o).repairedondate=s),type:"date",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[N,l(o).repairedondate]]),l(o).errors.repairedondate?(d(),n("div",Qe,r(l(o).errors.repairedondate),1)):b("",!0)]),e("div",We,[i($,{onClick:p},{default:u(()=>[...t[28]||(t[28]=[c("Cancel",-1)])]),_:1}),i(F,{type:"submit",disabled:l(o).processing},{default:u(()=>[t[29]||(t[29]=c(" Close ",-1)),l(o).processing?(d(),n("span",Xe,[i(L)])):b("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),i(S,{show:A.value,onClose:p},{default:u(()=>[e("div",null,[e("div",Ye,[e("div",et,[t[32]||(t[32]=e("h2",{class:"text-xl font-bold"}," Repair Details ",-1)),e("span",{class:h(["px-3 py-1 font-medium rounded-full",{"bg-green-100 text-green-700":m.value.status==="completed","bg-yellow-100 text-yellow-700":m.value.status==="pending","bg-red-100 text-red-700":m.value.status==="failed"}])},r(m.value.status),3)]),e("div",tt,[e("div",st,[t[33]||(t[33]=e("span",{class:""},"Truck",-1)),e("span",ot,r(m.value.truck.unitname),1)]),e("div",lt,[t[34]||(t[34]=e("span",{class:""},"Fault",-1)),e("span",rt,r(m.value.fault.name),1)]),e("div",dt,[t[35]||(t[35]=e("span",{class:""},"Last Reported At",-1)),e("span",at,r(m.value.last_reported_at),1)]),e("div",nt,[t[36]||(t[36]=e("span",{class:""},"Done By",-1)),e("span",it,r(m.value.done_by?.name??"N/A"),1)]),e("div",ut,[t[37]||(t[37]=e("span",{class:""},"Done On",-1)),e("span",mt,r(m.value.repairedondate??"N/A"),1)]),e("div",pt,[t[38]||(t[38]=e("p",{class:"mb-1"},"Job Description",-1)),e("p",ct,r(m.value.comments??"No description provided"),1)])]),e("div",{class:"mt-6 flex justify-end"},[e("button",{onClick:p,class:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition"}," Close ")])])])]),_:1},8,["show"])]),_:1})],64))}};export{Ft as default};

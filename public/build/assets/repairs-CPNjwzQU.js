import{g as d,b as e,o as n,x as q,p as x,u as A,a as l,d as a,h as Z,w as u,i as y,f as c,F as g,q as C,t as i,n as G,e as I,j as F,y as S,E as J}from"./app-DPFc9-e2.js";import{_ as K}from"./AuthenticatedLayout-DHgMUdAb.js";import{M as O}from"./MainContent-BjOld8RQ.js";import{P as Q,a as W}from"./PageTitle-CtgO6ozB.js";import{P as M}from"./PrimaryButton-Dq93tcsl.js";import{_ as D,a as B}from"./SecondaryButton-CNIrrfl7.js";import{D as X}from"./Deleteicon-9q5luQZh.js";import{E as Y}from"./Editicon-BEG3xixx.js";import{D as ee}from"./DangerButton-9PwAqYDS.js";import{S as V}from"./Spinner-BiKmwSKt.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={},oe={xmlns:"http://www.w3.org/2000/svg",fill:"#fff",viewBox:"0 0 24 29","stroke-width":"2",stroke:"#1F51FF",class:"inline-block w-5 h-6 mt-1",height:"1em"};function re(f,m){return n(),d("svg",oe,[...m[0]||(m[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"},null,-1)])])}const le=te(se,[["render",re]]),ae={key:0,class:"flex items-center gap-2"},de={key:0,class:"flex items-center"},ne={class:"px-2 overflow-x-auto"},ie={class:"min-w-full border border-gray-200"},ue={class:"text-center divide-y divide-gray-200"},ce={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},me={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},pe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},xe={class:"px-4 py-3 text-[14px] border-r border-gray-200"},fe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},be={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ye={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ge={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ve={class:"px-4 py-3 text-[14px] justify-center text-slate-900 border-r border-gray-200 flex gap-2"},_e=["onClick"],ke=["onClick"],he=["onClick"],we={key:1},Ce={class:"p-6 bg-white"},Fe={class:"mb-4 text-lg font-medium text-gray-900"},Se=["value"],Me={key:0,class:"mt-1 text-sm text-red-600"},Re=["value"],Ae={key:0,class:"mt-1 text-sm text-red-600"},De={key:0},Be={key:0,class:"mt-1 text-sm text-red-600"},Ve={class:"flex justify-end gap-3 mt-6"},$e={key:0,class:"flex items-center gap-2"},Ne={class:"p-6 bg-white"},Le={class:"flex justify-end gap-3 mt-6"},Je={__name:"repairs",props:{repairs:Array,trucks:Array,faults:Array,users:Array},setup(f){q().props;const m=x(!1),_=x(!1),k=x(null),p=x(null),$=x(null),h=A({}),N=x(!1),o=A({truck_id:"",fault_id:"",status:"pending",location:"",comments:"",donebyid:""}),L=()=>{p.value=null,o.reset(),m.value=!0},j=r=>{p.value=r,o.truck_id=r.truck_id,o.fault_id=r.fault_id,o.status=r.status,o.location=r.location,m.value=!0},E=r=>{$.value=r,o.truck_id=r.truck_id,o.truck=r.truck.unitname,o.comments=r.comments,o.fault=r.fault.name,o.fault_id=r.fault_id,N.value=!0},P=()=>{p.value?o.put(`/repairs/${p.value.id}`,{onSuccess:()=>v()}):o.post("/repairs",{onSuccess:()=>v()})},v=()=>{m.value=!1,o.reset(),p.value=null},z=r=>{k.value=r,_.value=!0},w=()=>{_.value=!1,k.value=null},T=()=>{h.delete(`/repairs/${k.value.id}`,{onSuccess:()=>w()})},U=r=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-300 text-green-800",on_hold:"bg-red-100 text-red-800"})[r]||"bg-gray-100 text-gray-800",b=x(!1);function H(){b.value||(b.value=!0,J.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{b.value=!1},preserveScroll:!0}))}return(r,t)=>(n(),d(g,null,[l(a(Z),{title:"Repairs"}),l(K,null,{default:u(()=>[l(O,null,{default:u(()=>[l(Q,null,{default:u(()=>[l(W,null,{default:u(()=>[...t[3]||(t[3]=[c("Repairs Management",-1)])]),_:1}),e("div",null,[l(M,{onClick:H,disabled:b.value},{default:u(()=>[b.value?(n(),d("span",ae,[t[4]||(t[4]=c(" Fetching Locations ",-1)),l(V)])):(n(),d(g,{key:1},[c(" Fetch Locations ")],64))]),_:1},8,["disabled"]),l(M,{onClick:L},{default:u(()=>[...t[5]||(t[5]=[c(" + New Repair ",-1)])]),_:1})])]),_:1}),a(h).recentlySuccessful?(n(),d("span",de,[...t[6]||(t[6]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):y("",!0),e("div",ne,[e("table",ie,[t[9]||(t[9]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Date "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Truck "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Fault "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Status "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Location "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Last Reported At "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Last Checked At "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Created By - Repaired By "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Actions ")])],-1)),e("tbody",ue,[f.repairs&&f.repairs.length?(n(!0),d(g,{key:0},C(f.repairs,s=>(n(),d("tr",{key:s.id,class:"odd:bg-gray-50"},[e("td",ce,i(s.created_at),1),e("td",me,i(s.truck.unitname),1),e("td",pe,i(s.fault.name),1),e("td",xe,[e("span",{class:G(["px-3 py-2 rounded text-xs font-semibold",U(s.status)])},i(s.status),3)]),e("td",fe,i(s.location||"N/A"),1),e("td",be,i(s.last_reported_at),1),e("td",ye,i(s.last_check_at||"N/A"),1),e("td",ge,[c(i(s.user.name),1),t[7]||(t[7]=e("br",null,null,-1)),c(" "+i(s.done_by?.name),1)]),e("td",ve,[e("button",{onClick:R=>j(s)},[l(Y)],8,_e),e("button",{title:"Close",class:"mr-2",onClick:R=>E(s)},[l(le)],8,ke),e("button",{onClick:R=>z(s)},[l(X)],8,he)])]))),128)):(n(),d("tr",we,[...t[8]||(t[8]=[e("td",{colspan:"8",class:"px-4 py-3 text-center text-gray-500"}," Nothing to show ",-1)])]))])])])]),_:1}),l(D,{show:m.value,onClose:v},{default:u(()=>[e("div",Ce,[e("h2",Fe,i(p.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:I(P,["prevent"]),class:"space-y-4"},[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Truck",-1)),F(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>a(o).truck_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[10]||(t[10]=e("option",{value:""},"Select a truck",-1)),(n(!0),d(g,null,C(f.trucks,s=>(n(),d("option",{key:s.id,value:s.id},i(s.unitname),9,Se))),128))],512),[[S,a(o).truck_id]]),a(o).errors.truck_id?(n(),d("div",Me,i(a(o).errors.truck_id),1)):y("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a(o).fault_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[12]||(t[12]=e("option",{value:""},"Select a Fault",-1)),(n(!0),d(g,null,C(f.faults,s=>(n(),d("option",{key:s.id,value:s.id},i(s.name),9,Re))),128))],512),[[S,a(o).fault_id]]),a(o).errors.fault_id?(n(),d("div",Ae,i(a(o).errors.fault_id),1)):y("",!0)]),r.editinguser?(n(),d("div",De,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),F(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a(o).role=s),id:"inputState",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[...t[14]||(t[14]=[e("option",{value:"1"},"Admin",-1),e("option",{value:"0"},"User",-1)])],512),[[S,a(o).role]]),a(o).errors.role?(n(),d("div",Be,i(a(o).errors.role),1)):y("",!0)])):y("",!0),e("div",Ve,[l(B,{onClick:v},{default:u(()=>[...t[16]||(t[16]=[c("Cancel",-1)])]),_:1}),l(M,{type:"submit",disabled:a(o).processing},{default:u(()=>[c(i(p.value?"Update":"Create")+" ",1),b.value||a(o).processing?(n(),d("span",$e,[l(V)])):y("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),l(D,{show:_.value,onClose:w},{default:u(()=>[e("div",Ne,[t[19]||(t[19]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",Le,[l(B,{onClick:w},{default:u(()=>[...t[17]||(t[17]=[c("Cancel",-1)])]),_:1}),l(ee,{onClick:T,disabled:a(h).processing},{default:u(()=>[...t[18]||(t[18]=[c(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64))}};export{Je as default};

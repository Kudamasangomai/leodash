import{g as a,b as e,o as d,p as T,q as g,u as S,a as o,d as l,h as U,w as u,i as f,f as p,F as y,s as C,t as i,n as j,e as q,k as F,C as D,m as G,D as I}from"./app-6SHAjh2j.js";import{_ as J}from"./AuthenticatedLayout-DDMVJATQ.js";import{M as K}from"./MainContent-COu6Eofw.js";import{P as O,a as Q}from"./PageTitle-BqnvKIfT.js";import{P as M}from"./PrimaryButton-D0SwgDW-.js";import{_ as V,a as L}from"./Modal-BMutqjXa.js";import{D as W}from"./Deleteicon-Bx3rHVSC.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{D as Y}from"./DangerButton-BWjFSHrV.js";import{S as A}from"./Spinner-CByljYDI.js";const Z={},ee={fill:"#1F51FF",xmlns:"http://www.w3.org/2000/svg",height:"1em","stroke-width":"1",viewBox:"0 0 512 512",class:"inline-block w-4 h-5"};function te(b,m){return d(),a("svg",ee,[...m[0]||(m[0]=[e("path",{d:"M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"},null,-1)])])}const se=X(Z,[["render",te]]),re={key:0,class:"flex items-center gap-2"},oe={key:0,class:"flex items-center"},le={class:"px-2 overflow-x-auto"},ae={class:"min-w-full border border-gray-200"},de={class:"text-center divide-y divide-gray-200"},ne={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ie={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ue={class:"px-4 py-3 text-[14px] border-r border-gray-200"},ce={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},pe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},me={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},be={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},xe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200 flex gap-2"},fe=["onClick"],ge=["onClick"],ye={key:1},_e={class:"p-6 bg-white"},ve={class:"mb-4 text-lg font-medium text-gray-900"},ke=["value"],he={key:0,class:"mt-1 text-sm text-red-600"},we=["value"],Ce={key:0,class:"mt-1 text-sm text-red-600"},Fe={key:0},Me={key:0,class:"mt-1 text-sm text-red-600"},Se={class:"flex justify-end gap-3 mt-6"},De={key:0,class:"flex items-center gap-2"},Ve={class:"p-6 bg-white"},Le={class:"flex justify-end gap-3 mt-6"},Ue={__name:"repairs",props:{repairs:Array,trucks:Array,faults:Array},setup(b){T().props;const m=g(!1),v=g(!1),k=g(null),c=g(null),r=S({truck_id:"",fault_id:"",status:"pending",location:""}),h=S({}),R=()=>{c.value=null,r.reset(),m.value=!0},z=n=>{c.value=n,r.truck_id=n.truck_id,r.fault_id=n.fault_id,r.status=n.status,r.location=n.location,m.value=!0},_=()=>{m.value=!1,r.reset(),c.value=null},B=()=>{c.value?r.put(`/repairs/${c.value.id}`,{onSuccess:()=>_(),onError:n=>{console.log("Errors:",n)}}):r.post("/repairs",{onSuccess:()=>_(),onError:n=>{console.log("Errors:",n)}})},N=n=>{k.value=n,v.value=!0},w=()=>{v.value=!1,k.value=null},$=()=>{h.delete(`/repairs/${k.value.id}`,{onSuccess:()=>w()})},E=n=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",on_hold:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",x=g(!1);function H(){x.value||(x.value=!0,I.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{x.value=!1},preserveScroll:!0}))}return(n,t)=>(d(),a(y,null,[o(l(U),{title:"Repairs"}),o(J,null,{default:u(()=>[o(K,null,{default:u(()=>[o(O,null,{default:u(()=>[o(Q,null,{default:u(()=>[...t[3]||(t[3]=[p("Repairs Management",-1)])]),_:1}),e("div",null,[o(M,{onClick:H,disabled:x.value},{default:u(()=>[x.value?(d(),a("span",re,[t[4]||(t[4]=p(" Fetching Locations ",-1)),o(A)])):(d(),a(y,{key:1},[p(" Fetch Locations ")],64))]),_:1},8,["disabled"]),o(M,{onClick:R},{default:u(()=>[...t[5]||(t[5]=[p(" + New Repair ",-1)])]),_:1})])]),_:1}),l(h).recentlySuccessful?(d(),a("span",oe,[...t[6]||(t[6]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):f("",!0),e("div",le,[e("table",ae,[t[8]||(t[8]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border border-r border-gray-300"},"Truck"),e("th",{class:"p-2 border border-r border-gray-300"},"Fault"),e("th",{class:"p-2 border border-r border-gray-300"},"Status"),e("th",{class:"p-2 border border-r border-gray-300"},"Location"),e("th",{class:"p-2 border border-r border-gray-300"},"last Reported At"),e("th",{class:"p-2 border border-r border-gray-300"},"last Checked At"),e("th",{class:"p-2 border border-r border-gray-300"},"Created By"),e("th",{class:"p-2 border border-r border-gray-300"},"Actions")])],-1)),e("tbody",de,[b.repairs&&b.repairs.length?(d(!0),a(y,{key:0},C(b.repairs,s=>(d(),a("tr",{key:s.id,class:"odd:bg-gray-50"},[e("td",ne,i(s.truck.unitname),1),e("td",ie,i(s.fault.name),1),e("td",ue,[e("span",{class:j(["px-3 py-2 rounded text-xs font-semibold",E(s.status)])},i(s.status),3)]),e("td",ce,i(s.location||"N/A"),1),e("td",pe,i(s.last_reported_at),1),e("td",me,i(s.last_check_at||"N/A"),1),e("td",be,i(s.user.name),1),e("td",xe,[e("button",{onClick:P=>z(s)},[o(se)],8,fe),e("button",{onClick:P=>N(s)},[o(W)],8,ge)])]))),128)):(d(),a("tr",ye,[...t[7]||(t[7]=[e("td",{colspan:"8",class:"px-4 py-3 text-center text-gray-500"}," Nothing to show ",-1)])]))])])])]),_:1}),o(V,{show:m.value,onClose:_},{default:u(()=>[e("div",_e,[e("h2",ve,i(c.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:q(B,["prevent"]),class:"space-y-4"},[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"Truck",-1)),F(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>l(r).truck_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[9]||(t[9]=e("option",{value:""},"Select a truck",-1)),(d(!0),a(y,null,C(b.trucks,s=>(d(),a("option",{key:s.id,value:s.id},i(s.unitname),9,ke))),128))],512),[[D,l(r).truck_id]]),l(r).errors.truck_id?(d(),a("div",he,i(l(r).errors.truck_id),1)):f("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l(r).fault_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[11]||(t[11]=e("option",{value:""},"Select a Fault",-1)),(d(!0),a(y,null,C(b.faults,s=>(d(),a("option",{key:s.id,value:s.id},i(s.name),9,we))),128))],512),[[D,l(r).fault_id]]),l(r).errors.fault_id?(d(),a("div",Ce,i(l(r).errors.fault_id),1)):f("",!0)]),c.value?(d(),a("div",Fe,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Location",-1)),F(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l(r).location=s),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[G,l(r).location]]),l(r).errors.location?(d(),a("div",Me,i(l(r).errors.location),1)):f("",!0)])):f("",!0),e("div",Se,[o(L,{onClick:_},{default:u(()=>[...t[14]||(t[14]=[p("Cancel",-1)])]),_:1}),o(M,{type:"submit",disabled:l(r).processing},{default:u(()=>[p(i(c.value?"Update":"Create")+" ",1),x.value||l(r).processing?(d(),a("span",De,[o(A)])):f("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),o(V,{show:v.value,onClose:w},{default:u(()=>[e("div",Ve,[t[17]||(t[17]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",Le,[o(L,{onClick:w},{default:u(()=>[...t[15]||(t[15]=[p("Cancel",-1)])]),_:1}),o(Y,{onClick:$,disabled:l(h).processing},{default:u(()=>[...t[16]||(t[16]=[p(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64))}};export{Ue as default};

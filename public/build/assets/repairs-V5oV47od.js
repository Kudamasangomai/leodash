import{g as u,b as e,o as a,y as ee,p,u as z,E as te,G as E,a as n,d as l,h as se,w as m,i as c,f as i,F as g,j as k,v as H,s as _,t as r,n as P,c as oe,l as le,e as q,z as h}from"./app-BiNClEIv.js";import{_ as re}from"./AuthenticatedLayout-BDTbnRUN.js";import{M as ae}from"./MainContent-ClWYe3aQ.js";import{P as de,a as ne}from"./PageTitle-C_OOQhDH.js";import{P as C}from"./PrimaryButton-Bn02N1uf.js";import{_ as F,a as j}from"./SecondaryButton-Bv0EOaR5.js";import{D as ue}from"./Deleteicon-Br6Xru-j.js";import{E as ie}from"./Editicon-LMUvYLdn.js";import{D as me}from"./DangerButton-BMuXqHmN.js";import{S as L}from"./Spinner-D4w0OTbu.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={},be={xmlns:"http://www.w3.org/2000/svg",fill:"#fff",viewBox:"0 0 24 29","stroke-width":"2",stroke:"#1F51FF",class:"inline-block w-5 h-6 mt-1",height:"1em"};function fe(b,x){return a(),u("svg",be,[...x[0]||(x[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"},null,-1)])])}const xe=pe(ce,[["render",fe]]),ye={key:0,class:"flex items-center gap-2"},ge={key:0,class:"flex items-center"},ve={class:"py-4 ml-2"},ke={class:"relative flex justify-end w-full mt-1 mr-1 md:w-1/3 md:ml-auto"},_e={class:"px-2 overflow-x-auto"},we={class:"min-w-full border border-gray-200"},he={class:"text-center divide-y divide-gray-200"},Ce={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Fe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Se=["onClick"],Me={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Re={class:"px-4 py-3 text-[14px] border-r border-gray-200"},De={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Ae={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Be={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},Ve={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},$e={class:"px-4 py-3 text-[14px] justify-center text-slate-900 border-r border-gray-200 flex gap-2"},Ne=["onClick"],je=["onClick"],Le=["onClick"],Te={key:1},Ue={class:"flex gap-2 mt-4 justify-end"},ze={class:"p-6 bg-white"},Ee={class:"mb-4 text-lg font-medium text-gray-900"},He=["value"],Pe={key:0,class:"mt-1 text-sm text-red-600"},qe=["value"],Je={key:0,class:"mt-1 text-sm text-red-600"},Oe={key:0},Ge={key:0,class:"mt-1 text-sm text-red-600"},Ze={class:"flex justify-end gap-3 mt-6"},Ie={key:0,class:"flex items-center gap-2"},Ke={class:"p-6 bg-white"},Qe={class:"flex justify-end gap-3 mt-6"},We={class:"p-6 bg-white"},Xe={key:0,class:"mt-1 text-sm text-red-600"},Ye=["value"],et={key:0,class:"mt-1 text-sm text-red-600"},tt={class:"flex justify-end gap-3 mt-6"},st={key:0,class:"flex items-center gap-2"},ot={class:"bg-white rounded-lg p-6 w-96"},ft={__name:"repairs",props:{repairs:Object,trucks:Array,faults:Array,users:Array},setup(b){ee().props;const x=p(!1),S=p(!1),M=p(null),y=p(null),T=p(null),R=z({}),D=p(!1),o=z({truck_id:"",fault_id:"",status:"pending",location:"",comments:"",donebyid:""}),J=()=>{y.value=null,o.reset(),x.value=!0},O=d=>{y.value=d,o.truck_id=d.truck_id,o.fault_id=d.fault_id,o.status=d.status,o.location=d.location,x.value=!0},G=d=>{T.value=d,o.truck_id=d.truck_id,o.truck=d.truck.unitname,o.comments=d.comments,o.fault=d.fault.name,o.fault_id=d.fault_id,D.value=!0},Z=()=>{y.value?o.put(`/repairs/${y.value.id}`,{onSuccess:()=>w()}):o.post("/repairs",{onSuccess:()=>w()})},I=()=>{o.put(`/repairs/closerepair/${T.value.id}`,{onSuccess:()=>A()})},w=()=>{x.value=!1,o.reset(),y.value=null},A=()=>{D.value=!1,o.reset()},K=d=>{M.value=d,S.value=!0},B=()=>{S.value=!1,M.value=null},Q=()=>{R.delete(`/repairs/${M.value.id}`,{onSuccess:()=>B()})},W=d=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-300 text-green-800",on_hold:"bg-red-100 text-red-800"})[d]||"bg-gray-100 text-gray-800",v=p(!1);function X(){v.value||(v.value=!0,E.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{v.value=!1},preserveScroll:!0}))}const V=p("");te(V,d=>{E.get("/repairs",d?{q:d}:{},{preserveState:!0,preserveScroll:!0,replace:!0})});const $=p(!1),f=p(null);function Y(d){f.value=d,$.value=!0}function U(){$.value=!1,f.value=null}return(d,t)=>(a(),u(g,null,[n(l(se),{title:"Repairs"}),n(re,null,{default:m(()=>[n(ae,null,{default:m(()=>[n(de,null,{default:m(()=>[n(ne,null,{default:m(()=>[...t[6]||(t[6]=[i("Repairs Management",-1)])]),_:1}),e("div",null,[n(C,{onClick:X,disabled:v.value},{default:m(()=>[v.value?(a(),u("span",ye,[t[7]||(t[7]=i(" Fetching Locations ",-1)),n(L)])):(a(),u(g,{key:1},[i(" Fetch Locations ")],64))]),_:1},8,["disabled"]),n(C,{onClick:J},{default:m(()=>[...t[8]||(t[8]=[i(" + New Repair ",-1)])]),_:1})])]),_:1}),l(R).recentlySuccessful?(a(),u("span",ge,[...t[9]||(t[9]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):c("",!0),e("div",ve,[t[10]||(t[10]=e("label",{for:"table-search",class:"sr-only"},"Search",-1)),e("div",ke,[k(e("input",{type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm",placeholder:"Search for truck or Fault","onUpdate:modelValue":t[0]||(t[0]=s=>V.value=s)},null,512),[[H,V.value]])])]),e("div",_e,[e("table",we,[t[13]||(t[13]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Date "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Truck "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Fault "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Status "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Location "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Last Reported At "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Last Checked At "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Created By - Repaired By "),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"}," Actions ")])],-1)),e("tbody",he,[b.repairs.data&&b.repairs.data.length?(a(!0),u(g,{key:0},_(b.repairs.data,s=>(a(),u("tr",{key:s.id,class:"odd:bg-gray-50"},[e("td",Ce,r(s.created_at),1),e("td",Fe,[e("button",{onClick:N=>Y(s),class:"text-blue-500"},r(s.truck.unitname),9,Se)]),e("td",Me,r(s.fault.name),1),e("td",Re,[e("span",{class:P(["px-3 py-2 rounded text-xs font-semibold",W(s.status)])},r(s.status),3)]),e("td",De,r(s.location||"N/A"),1),e("td",Ae,r(s.last_reported_at),1),e("td",Be,r(s.last_check_at||"N/A"),1),e("td",Ve,[i(r(s.user.name),1),t[11]||(t[11]=e("br",null,null,-1)),i(" "+r(s.done_by?.name),1)]),e("td",$e,[e("button",{onClick:N=>O(s)},[n(ie)],8,Ne),e("button",{title:"Close",class:"mr-2",onClick:N=>G(s)},[n(xe)],8,je),e("button",{onClick:N=>K(s)},[n(ue)],8,Le)])]))),128)):(a(),u("tr",Te,[...t[12]||(t[12]=[e("td",{colspan:"8",class:"px-4 py-3 text-center text-gray-500"}," Nothing to show ",-1)])]))])]),e("div",Ue,[(a(!0),u(g,null,_(b.repairs.links,s=>(a(),oe(l(le),{key:s.label,href:s.url??"",innerHTML:s.label,class:P(["px-3 py-1 border rounded border-gray-200",{"bg-blue-500 text-white":s.active,"text-gray-400":!s.url}]),"preserve-scroll":""},null,8,["href","innerHTML","class"]))),128))])])]),_:1}),n(F,{show:x.value,onClose:w},{default:m(()=>[e("div",ze,[e("h2",Ee,r(y.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:q(Z,["prevent"]),class:"space-y-4"},[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Truck",-1)),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l(o).truck_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[14]||(t[14]=e("option",{value:""},"Select a truck",-1)),(a(!0),u(g,null,_(b.trucks,s=>(a(),u("option",{key:s.id,value:s.id},r(s.unitname),9,He))),128))],512),[[h,l(o).truck_id]]),l(o).errors.truck_id?(a(),u("div",Pe,r(l(o).errors.truck_id),1)):c("",!0)]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),k(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l(o).fault_id=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[16]||(t[16]=e("option",{value:""},"Select a Fault",-1)),(a(!0),u(g,null,_(b.faults,s=>(a(),u("option",{key:s.id,value:s.id},r(s.name),9,qe))),128))],512),[[h,l(o).fault_id]]),l(o).errors.fault_id?(a(),u("div",Je,r(l(o).errors.fault_id),1)):c("",!0)]),d.editinguser?(a(),u("div",Oe,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),k(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>l(o).role=s),id:"inputState",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[...t[18]||(t[18]=[e("option",{value:"1"},"Admin",-1),e("option",{value:"0"},"User",-1)])],512),[[h,l(o).role]]),l(o).errors.role?(a(),u("div",Ge,r(l(o).errors.role),1)):c("",!0)])):c("",!0),e("div",Ze,[n(j,{onClick:w},{default:m(()=>[...t[20]||(t[20]=[i("Cancel",-1)])]),_:1}),n(C,{type:"submit",disabled:l(o).processing},{default:m(()=>[i(r(y.value?"Update":"Create")+" ",1),v.value||l(o).processing?(a(),u("span",Ie,[n(L)])):c("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),n(F,{show:S.value,onClose:B},{default:m(()=>[e("div",Ke,[t[23]||(t[23]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",Qe,[n(j,{onClick:B},{default:m(()=>[...t[21]||(t[21]=[i("Cancel",-1)])]),_:1}),n(me,{onClick:Q,disabled:l(R).processing},{default:m(()=>[...t[22]||(t[22]=[i(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"]),n(F,{show:D.value,onClose:A},{default:m(()=>[e("div",We,[t[29]||(t[29]=e("h2",{class:"mb-4 text-lg font-medium text-gray-900"}," Close Repair ",-1)),e("h6",null,"Truck - "+r(l(o).truck),1),e("h6",null,"Fault - "+r(l(o).fault),1),e("form",{onSubmit:q(I,["prevent"]),class:"space-y-4"},[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Job Done / comment",-1)),k(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l(o).comments=s),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[H,l(o).comments]]),l(o).errors.comments?(a(),u("div",Xe,r(l(o).errors.comments),1)):c("",!0),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),k(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l(o).donebyid=s),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[24]||(t[24]=e("option",{value:""},"Done By",-1)),(a(!0),u(g,null,_(b.users,s=>(a(),u("option",{key:s.id,value:s.id},r(s.name),9,Ye))),128))],512),[[h,l(o).donebyid]]),l(o).errors.fault_id?(a(),u("div",et,r(l(o).errors.user_id),1)):c("",!0)]),e("div",tt,[n(j,{onClick:A},{default:m(()=>[...t[26]||(t[26]=[i("Cancel",-1)])]),_:1}),n(C,{type:"submit",disabled:l(o).processing},{default:m(()=>[t[27]||(t[27]=i(" Close ",-1)),l(o).processing?(a(),u("span",st,[n(L)])):c("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),n(F,{show:$.value,onClose:U},{default:m(()=>[e("div",null,[e("div",ot,[t[36]||(t[36]=e("h2",{class:"text-xl font-bold mb-4"},"Repair Details",-1)),e("p",null,[t[30]||(t[30]=e("strong",null,"Unit:",-1)),i(" "+r(f.value.truck.unitname),1)]),e("p",null,[t[31]||(t[31]=e("strong",null,"Status:",-1)),i(" "+r(f.value.status),1)]),e("p",null,[t[32]||(t[32]=e("strong",null,"Fault:",-1)),i(" "+r(f.value.fault.name),1)]),e("p",null,[t[33]||(t[33]=e("strong",null,"Reported At:",-1)),i(" "+r(f.value.last_reported_at),1)]),e("p",null,[t[34]||(t[34]=e("strong",null,"Done By:",-1)),i(" "+r(f.value.done_by?.name??"N/A"),1)]),e("p",null,[t[35]||(t[35]=e("strong",null,"Job Description:",-1)),i(" "+r(f.value.comments??"N/A"),1)]),e("button",{onClick:U,class:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"}," Close ")])])]),_:1},8,["show"])]),_:1})],64))}};export{ft as default};

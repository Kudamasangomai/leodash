import{g as a,b as e,o as d,y as I,p as b,u as T,a as l,d as r,h as K,w as u,i as c,f as m,F as g,s as k,t as n,n as O,e as j,j as v,z as D,v as z,G as Q}from"./app-DWFvXeVJ.js";import{_ as W}from"./AuthenticatedLayout-BbqidcH0.js";import{M as X}from"./MainContent-yjVX7Gsb.js";import{P as Y,a as ee}from"./PageTitle-DztBbiXq.js";import{P as w}from"./PrimaryButton-COtfuGAH.js";import{_ as A}from"./SecondaryButton-BBI7dk0C.js";import{_ as V}from"./Modal-BJGKkElx.js";import{D as te}from"./Deleteicon-SWSpIOJs.js";import{E as se}from"./Editicon-CqtLg82l.js";import{D as oe}from"./DangerButton-bJWA9dLn.js";import{S as B}from"./Spinner-B0wXp3Jj.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={},ae={xmlns:"http://www.w3.org/2000/svg",fill:"#fff",viewBox:"0 0 24 29","stroke-width":"2",stroke:"#1F51FF",class:"inline-block w-5 h-6",height:"1em"};function de(f,x){return d(),a("svg",ae,[...x[0]||(x[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"},null,-1)])])}const ne=re(le,[["render",de]]),ie={key:0,class:"flex items-center gap-2"},ue={key:0,class:"flex items-center"},me={class:"px-2 overflow-x-auto"},ce={class:"min-w-full border border-gray-200"},pe={class:"text-center divide-y divide-gray-200"},fe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},xe={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},be={class:"px-4 py-3 text-[14px] border-r border-gray-200"},ye={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ge={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ve={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},_e={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200"},ke={class:"px-4 py-3 text-[14px] text-slate-900 border-r border-gray-200 flex gap-2"},we=["onClick"],he=["onClick"],Ce=["onClick"],Fe={key:1},Me={class:"p-6 bg-white"},Re={class:"mb-4 text-lg font-medium text-gray-900"},Se=["value"],De={key:0,class:"mt-1 text-sm text-red-600"},Ae=["value"],Ve={key:0,class:"mt-1 text-sm text-red-600"},Be={key:0},$e={key:0,class:"mt-1 text-sm text-red-600"},Ne={class:"flex justify-end gap-3 mt-6"},Te={key:0,class:"flex items-center gap-2"},je={class:"p-6 bg-white"},ze={class:"flex justify-end gap-3 mt-6"},Le={class:"p-6 bg-white"},Pe={key:0,class:"mt-1 text-sm text-red-600"},Ue=["value"],Ee={key:0,class:"mt-1 text-sm text-red-600"},He={class:"flex justify-end gap-3 mt-6"},qe={key:0,class:"flex items-center gap-2"},st={__name:"repairs",props:{repairs:Array,trucks:Array,faults:Array,users:Array},setup(f){I().props;const x=b(!1),h=b(!1),C=b(null),p=b(null),$=b(null),F=T({}),M=b(!1),s=T({truck_id:"",fault_id:"",status:"pending",location:"",comments:"",donebyid:""}),L=()=>{p.value=null,s.reset(),x.value=!0},P=i=>{p.value=i,s.truck_id=i.truck_id,s.fault_id=i.fault_id,s.status=i.status,s.location=i.location,x.value=!0},U=i=>{$.value=i,s.truck_id=i.truck_id,s.truck=i.truck.unitname,s.comments=i.comments,s.fault=i.fault.name,s.fault_id=i.fault_id,M.value=!0},E=()=>{p.value?s.put(`/repairs/${p.value.id}`,{onSuccess:()=>_()}):s.post("/repairs",{onSuccess:()=>_()})},H=()=>{s.put(`/repairs/closerepair/${$.value.id}`,{onSuccess:()=>R()})},_=()=>{x.value=!1,s.reset(),p.value=null},R=()=>{M.value=!1,s.reset()},q=i=>{C.value=i,h.value=!0},S=()=>{h.value=!1,C.value=null},G=()=>{F.delete(`/repairs/${C.value.id}`,{onSuccess:()=>S()})},J=i=>({pending:"bg-yellow-300 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-300 text-green-800",on_hold:"bg-red-100 text-red-800"})[i]||"bg-gray-100 text-gray-800",y=b(!1);function Z(){y.value||(y.value=!0,Q.visit("/repairs/fetchlocations",{method:"get",onFinish:()=>{y.value=!1},preserveScroll:!0}))}return(i,t)=>(d(),a(g,null,[l(r(K),{title:"Repairs"}),l(W,null,{default:u(()=>[l(X,null,{default:u(()=>[l(Y,null,{default:u(()=>[l(ee,null,{default:u(()=>[...t[5]||(t[5]=[m("Repairs Management",-1)])]),_:1}),e("div",null,[l(w,{onClick:Z,disabled:y.value},{default:u(()=>[y.value?(d(),a("span",ie,[t[6]||(t[6]=m(" Fetching Locations ",-1)),l(B)])):(d(),a(g,{key:1},[m(" Fetch Locations ")],64))]),_:1},8,["disabled"]),l(w,{onClick:L},{default:u(()=>[...t[7]||(t[7]=[m(" + New Repair ",-1)])]),_:1})])]),_:1}),r(F).recentlySuccessful?(d(),a("span",ue,[...t[8]||(t[8]=[e("div",{class:"flex justify-center w-full"},[e("div",{class:"w-1/2 px-4 py-3 mb-4 text-teal-900 bg-teal-100 border-t-4 border-teal-500 rounded-b shadow-md",role:"alert"},[e("div",{class:"flex"},[e("div",{class:"py-1"},[e("svg",{class:"w-6 h-6 mr-4 text-teal-500 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),e("div",null,[e("p",{class:"font-bold"}," Record Deleted Successfully ")])])])],-1)])])):c("",!0),e("div",me,[e("table",ce,[t[11]||(t[11]=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Truck"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Fault"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Status"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Location"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"last Reported At"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"last Checked At"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Created By - Repaired By"),e("th",{class:"p-2 border font-medium border-r text-[13px] border-gray-300"},"Actions")])],-1)),e("tbody",pe,[f.repairs&&f.repairs.length?(d(!0),a(g,{key:0},k(f.repairs,o=>(d(),a("tr",{key:o.id,class:"odd:bg-gray-50"},[e("td",fe,n(o.truck.unitname),1),e("td",xe,n(o.fault.name),1),e("td",be,[e("span",{class:O(["px-3 py-2 rounded text-xs font-semibold",J(o.status)])},n(o.status),3)]),e("td",ye,n(o.location||"N/A"),1),e("td",ge,n(o.last_reported_at),1),e("td",ve,n(o.last_check_at||"N/A"),1),e("td",_e,[m(n(o.user.name),1),t[9]||(t[9]=e("br",null,null,-1)),m(" "+n(o.done_by?.name),1)]),e("td",ke,[e("button",{onClick:N=>P(o)},[l(se)],8,we),e("button",{title:"Close",class:"mr-2",onClick:N=>U(o)},[l(ne)],8,he),e("button",{onClick:N=>q(o)},[l(te)],8,Ce)])]))),128)):(d(),a("tr",Fe,[...t[10]||(t[10]=[e("td",{colspan:"8",class:"px-4 py-3 text-center text-gray-500"}," Nothing to show ",-1)])]))])])])]),_:1}),l(V,{show:x.value,onClose:_},{default:u(()=>[e("div",Me,[e("h2",Re,n(p.value?"Edit Repair":"Create New Repair"),1),e("form",{onSubmit:j(E,["prevent"]),class:"space-y-4"},[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Truck",-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>r(s).truck_id=o),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[12]||(t[12]=e("option",{value:""},"Select a truck",-1)),(d(!0),a(g,null,k(f.trucks,o=>(d(),a("option",{key:o.id,value:o.id},n(o.unitname),9,Se))),128))],512),[[D,r(s).truck_id]]),r(s).errors.truck_id?(d(),a("div",De,n(r(s).errors.truck_id),1)):c("",!0)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),v(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r(s).fault_id=o),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[14]||(t[14]=e("option",{value:""},"Select a Fault",-1)),(d(!0),a(g,null,k(f.faults,o=>(d(),a("option",{key:o.id,value:o.id},n(o.name),9,Ae))),128))],512),[[D,r(s).fault_id]]),r(s).errors.fault_id?(d(),a("div",Ve,n(r(s).errors.fault_id),1)):c("",!0)]),p.value?(d(),a("div",Be,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Location",-1)),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r(s).location=o),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[z,r(s).location]]),r(s).errors.location?(d(),a("div",$e,n(r(s).errors.location),1)):c("",!0)])):c("",!0),e("div",Ne,[l(A,{onClick:_},{default:u(()=>[...t[17]||(t[17]=[m("Cancel",-1)])]),_:1}),l(w,{type:"submit",disabled:r(s).processing},{default:u(()=>[m(n(p.value?"Update":"Create")+" ",1),y.value||r(s).processing?(d(),a("span",Te,[l(B)])):c("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),l(V,{show:h.value,onClose:S},{default:u(()=>[e("div",je,[t[20]||(t[20]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this repair record? ",-1)),e("div",ze,[l(A,{onClick:S},{default:u(()=>[...t[18]||(t[18]=[m("Cancel",-1)])]),_:1}),l(oe,{onClick:G,disabled:r(F).processing},{default:u(()=>[...t[19]||(t[19]=[m(" Delete ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"]),l(V,{show:M.value,onClose:R},{default:u(()=>[e("div",Le,[t[26]||(t[26]=e("h2",{class:"mb-4 text-lg font-medium text-gray-900"}," Close Repair ",-1)),e("h6",null," Truck - "+n(r(s).truck),1),e("h6",null," Fault - "+n(r(s).fault),1),e("form",{onSubmit:j(H,["prevent"]),class:"space-y-4"},[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Job Done / comment",-1)),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r(s).comments=o),type:"text",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},null,512),[[z,r(s).comments]]),r(s).errors.comments?(d(),a("div",Pe,n(r(s).errors.comments),1)):c("",!0),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Fault",-1)),v(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>r(s).donebyid=o),required:"",class:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded shadow-sm"},[t[21]||(t[21]=e("option",{value:""},"Done By",-1)),(d(!0),a(g,null,k(f.users,o=>(d(),a("option",{key:o.id,value:o.id},n(o.name),9,Ue))),128))],512),[[D,r(s).donebyid]]),r(s).errors.fault_id?(d(),a("div",Ee,n(r(s).errors.user_id),1)):c("",!0)]),e("div",He,[l(A,{onClick:R},{default:u(()=>[...t[23]||(t[23]=[m("Cancel",-1)])]),_:1}),l(w,{type:"submit",disabled:r(s).processing},{default:u(()=>[t[24]||(t[24]=m(" Close ",-1)),r(s).processing?(d(),a("span",qe,[l(B)])):c("",!0)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"])]),_:1})],64))}};export{st as default};
